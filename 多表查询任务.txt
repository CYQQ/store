SELECT a.dname,a.loc,b.*
FROM t_dept a 
JOIN (select count(*) ,deptno from t_employees GROUP BY deptno) b
on a.deptno=b.deptno

3. 列出所有员工的姓名及其直接上级的姓名。
SELECT t1.ename,t2.ename
from t_employees t1
LEFT join t_employees t2 on t1.MGR=t2.empno

4. 列出受雇日期早于直接上级的所有员工的编号、姓名、部门名称。
SELECT a.empno,a.ename,b.dname
from t_employees a
join
(SELECT t1.empno,t1.ename,t1.MGR,t1.hiredate,t1.deptno,t2.dname from t_employees t1 join t_dept t2 on t1.deptno=t2.deptno ) b
on a.MGR=b.empno
WHERE a.hiredate<b.hiredate

5. 列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门。
SELECT *
from t_dept a
left join t_employees b
on a.deptno=b.deptno


7. 列出最低薪金大于15000的各种工作及从事此工作的员工人数。
SELECT count(*),job
FROM (SELECT job from t_employees WHERE sal>2000) j
GROUP BY j.job


8. 列出在公关部工作的员工的姓名，假定不知道公关部的部门编号。
SELECT a.dname,a.ename
FROM
(SELECT t1.dname,t2.ename
from t_dept t1,t_employees t2
WHERE t1.deptno=t2.deptno) a
WHERE a.dname='公关部'

9. 列出薪金高于公司平均薪金的所有员工信息，所在部门名称，上级领导，工资等级。
SELECT *
FROM
(SELECT a.empno,a.ename,a.MGR,a.sal,a.deptno,a.job,t_employees.ename '上级'
FROM
(SELECT * from t_employees WHERE sal>(SELECT AVG(sal) FROM t_employees)) a
JOIN t_employees on a.MGR=t_employees.empno) b
JOIN t_dept on b.deptno=t_dept.deptno

10.列出与张飞从事相同工作的所有员工及部门名称。
SELECT *
FROM
(SELECT *
FROM t_employees
WHERE job=(SELECT job from t_employees WHERE ename='张飞')) a
JOIN t_dept on a.deptno=t_dept.deptno

11.列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金、部门名称。
SELECT *
FROM
(SELECT *
FROM t_employees
WHERE sal>(SELECT max(sal) from t_employees WHERE deptno=30)) a
JOIN t_dept on a.deptno=t_dept.deptno
